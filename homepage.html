<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>MainPage</title>
  <link rel="stylesheet" href="homepagestyle.css" />
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>  
</head>
<body>
  <div id="loadingOverlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:9999;">
  <p style="text-align:center; margin-top:50vh;">Loading...</p>
  </div>

<div id="homepageContent" style="opacity:0;">
  <!-- All homepage content here -->

<div id="main-container">
    <!-- ğŸ  Home Content -->
  <div id="home" class="page">  <!-- ğŸ” Top Tabs -->

    <div class="top-bar">
      <div class="top-bar-row">

        <!-- Profile -->
        <div class="profile-wrapper">
          <img id="profilePhoto" src="https://pqrgvelzxmtdqrofxujx.supabase.co/storage/v1/object/public/profile_photos/default.jpg" alt="Profile Photo" class="profile-photo" />
       <!--   <img id="petDisplay" src="https://pqrgvelzxmtdqrofxujx.supabase.co/storage/v1/object/public/pet_photos/default.jpg" class="pet-overlay" /> -->
        </div>

        <!-- Level + Streak -->
        <div class="center-counters">
          <span class="counter">ğŸŒ <span id="currentLevel">0</span></span>
          <span class="counter" id="streak">
            <span class="fire">ğŸ”¥</span> 
            <span id="streak-counter">0</span>
          </span>
        </div>

        <!-- Side Menu -->
        <div id="menuButton" class="menu-button">â˜°</div>
        <div id="sideMenu" class="side-menu">
          <button class="menu-item" id="aboutUsBtn">About Us</button>
          <button class="menu-item" id="helpusgrowBtn">Help Us Grow</button>
      <!--     <button onclick="showSection('sources')" class="menu-item" id="sourcesBtn">Sources</button> -->
        </div>
      </div>

      <!-- XP Progress -->
      <div class="level-bar">
        <div class="progress">
          <div id="levelProgress" class="progress-fill"></div>
        </div>
        <small id="xpToNext"> </small>
      </div>
    </div>
    <!-- End Top Tabs -->


      <div class="top-buttons-wrapper">
        <div class="top-buttons">
        <button id="checkinBtn" class="checkin-btn"><span class="btn-text">Daily Check-in</span></button>
        <button id="healthBtn" class="health-btn hidden"><span class="btn-text">Health Solutions</span></button>
      </div>

 
    </div>

<div class = impact-box>
  <p><span class="you">You, </span>and our <span class="community">Community</span> <br>
  
<div class="impact-cards">
  
  <!-- Animals -->
  <div class="card">
    ğŸ¾
    <p> saved <br>
       <strong id="youAnimals">12</strong> 
       <strong id="communityAnimals">3560</strong> </p>
    <p>animals</p>
  </div>

  <!-- Forest -->
  <div class="card">
    ğŸŒ²
    <p> saved <br>
       <strong id="youForest">12</strong> 
       <strong id="communityForest">3560</strong> </p>
    <p> mÂ² of forests</p>
  </div>

  <!-- Water -->
  <div class="card">
    ğŸ’§
    <p> saved <br>
       <strong id="youWater">12</strong> 
       <strong id="communityWater">3560</strong> </p>
    <p>L of water</p>
  </div>

  <!-- COâ‚‚ -->
  <div class="card">
    ğŸŒ¬ï¸
    <p> reduced <br>
       <strong id="youCO2">12</strong> 
       <strong id="communityCO2">3560</strong> </p>
    <p>kg of COâ‚‚</p>
  </div>
 </div>
</div>

      <!-- Meal-Art Contest -->
      <div class="meal-art-winners">
        <h3>ğŸ½ï¸ <span class="mealartBtn">Meal-Art</span> Winners This Week:</h3>
        <div class="meal-art-categories">

          <!-- Amateur -->
          <div class="meal-art-card">
            <h4>ğŸ¥• Home Chef</h4>
            <p class="winner-name" id="amateurName">Jane Doe</p>
            <img id="amateurImage" src="meals/amateur.jpg" alt="Amateur winning dish" class="meal-art-image">
            <div id="amateurRecipe"><span class="recipe">Recipe available</span></div>
          </div>

          <!-- Professional -->
          <div class="meal-art-card">
            <h4>ğŸ´ Pro Kitchen</h4>
            <p class="winner-name" id="proName">Green Leaf Bistro</p>
            <img id="proImage" src="meals/professional.jpg" alt="Professional winning dish" class="meal-art-image">
            <div id="professionalRecipe"><span class="no-recipe">Recipe unavailable</span></div>
          </div>
        </div>
      </div>
  </div>  
<!-- End Home Page-->
 <!-- End Home Page-->
  <!-- End Home Page-->
   <!-- End Home Page-->
    <!-- End Home Page-->

    <!-- Top Bar -->
     <!-- Top Bar -->
      <!-- Top Bar -->
       <!-- Top Bar -->
<!-- settings -->   
 <!-- settings -->   
  <!-- settings -->   
   <!-- settings -->        
<div id="settings" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
  <div class="containersettings active">
    <h1 class="settingsh1">My Profile</h1>

    <div class="profile-sectionsettings">
        <img id="profilePhotoprofile" class="profile-photosettings" src="blankphoto.jpg" alt="Profile Photo">
        <div class="profile-infosettings">
            <div class="info-itemsettings"><strong>Name:</strong> <br><span id="profileName">-</span></div>
            <div class="info-itemsettings"><strong>Diet:</strong><br> <span id="diet">-</span></div>
        </div>
    </div>

<div class="profile-counterssettings">
  <span class="countersettings">ğŸŒ <span id="currentLevelprofile">0</span></span>
  <span class="countersettings">ğŸ”¥ <span id="streak-counterprofile">0</span></span>
  <span class="countersettings">ğŸ… <span id="badgeprofile">0</span></span>
</div>

    <div class="section-titlesettings">Goals</div>
<ul id="goalsList" class="details-listsettings"></ul>

<div class="section-titlesettings">Health Issues</div>
<ul id="healthIssuesList" class="details-listsettings"></ul>

    <div class="profile-sectionsettings">
        <img id="petPhotoprofile" class="pet-photosettings" src="defaultPet.jpg" alt="Pet Photo">
        <div class="profile-infosettings">
            <div class="info-item"><strong>Pet Name:</strong> <br><span id="petNameprofile">-</span></div>
        </div>
    </div>
    <a href="#" class="editprofile"> <button>Edit profile</button></a>
  </div>

  <div class="containeredit hidden">
    <h1 class="settingsh1">Edit My Profile</h1>

    <!-- Profile Info -->
      <div class="profile-sectionsettings">
        <img id="profilePhotoPreview" class="profile-photosettings" src="blankphoto.jpg" alt="Profile Photo">
        <input type="text-hidden" id="profilePhotoInput">

        <div class="profile-infoedit">
          <div class="info-itemsettings">
        <label for="profileNameInput"><strong>Name:</strong></label>
        <input type="text" id="profileNameInput" placeholder="Enter your name">
        </div>
          <div class="info-itemsettings">

        <label for="profileDietSelect"><strong>Diet:</strong></label>
  <select id="profileDietSelect">
    <option value="vegan">Vegan</option>
    <option value="intransition">In Transition</option>
    <option value="vegetarian">Vegetarian</option>
    <option value="pescatarian">Pescatarian</option>
    <option value="Flexitarian">Flexitarian</option>
    <option value="omnivore">Omnivore</option>
  </select>
          </div>
        </div>
      </div>

          <div class="changebtn">
            <input type="file" id="profilePhotoUpload" accept="image/*" style="display: none;">
            <button class="button" id="changeProfilePhotoBtn">Change Profile Photo</button>
          </div>

      <!-- Lists -->
      <!-- Q2: Goals -->
<div class="question" id="q2">
  <div class="section-titleedit">Goals:</div>

  <label class="checkbox-label">
    <input type="checkbox" name="goal" value="Protecting animals & animal welfare">
    Protecting animals
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="goal" value="Caring for the environment & fighting climate change">
    Caring for the environment
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="goal" value="Healthy living & wellness">
    Healthy living
  </label> 
  <label class="checkbox-label">
    <input type="checkbox" name="goal" value="Solving health issues">
    Solving health issues
  </label> 
  <label class="checkbox-label">
    <input type="checkbox" name="goal" value="Boosting my performance as an athlete">
    Boosting my performance as an athlete
  </label>
</div>

<!-- Q2b: Health Issues (shown only if "Solving health issues" is checked) -->
<div class="question" id="q2b">
  <div class="section-titleedit">Health Issues:</div>

  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Heart disease">
    Heart disease
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="High cholesterol">
    High cholesterol
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="High blood pressure">
    High blood pressure
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Type 2 diabetes">
    Type 2 diabetes
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Obesity">
    Obesity
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Digestive issues">
    Digestive issues
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Inflammation or swelling">
    Inflammation or swelling
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Fatigue">
    Fatigue
  </label>
  <label class="checkbox-label">
    <input type="checkbox" name="healthIssue" value="Cancer risk">
    Concerned about cancer risk
  </label>
</div>


      <!-- Pet Info -->
      <div class="profile-sectionsettings"><br>
        <img id="petPhotoPreview" class="pet-photosettings" src="defaultPet.jpg" alt="Pet Photo"> 
        <input type="text-hidden" id="petPhotoInput">
        <div class="profile-infoedit">
          <div class="info-itemsettings">
        <label for="petNameInput"><strong>Pet Name:</strong></label>
        <input type="text" id="petNameInput" placeholder="Enter pet name">
        </div>
          <div class="info-itemsettings">
            <input type="file" id="petPhotoUpload" accept="image/*" style="display: none;">
            <button class="button" id="changePetPhotoBtn">Change Pet Photo</button>
          </div>
        </div>
      </div>

      <div style="text-align:center; margin:1rem 0;">
        <button class="button" id="saveBtn">ğŸ’¾ Save Profile</button>
      </div> 
  </div>
</div>

<!-- SupportUs -->   
 <!-- SupportUs -->   
  <!-- SupportUs -->   
   <!-- SupportUs -->   
<div id="supportus" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 

  <div class="explanationsupportus">
    <div class="message-section">
      <div class="buddy-messagesupportus">
        <img src="characters/eluna.png" alt="Eluna" class="buddy-portraitsupportus" />
        <div class="buddy-text">
          <strong style="font-size: 1.1em; line-height: 1.3rem;">Eluna says:</strong><br> 
       <!--   We believe in full transparency. Every euro you donate goes directly to projects that make a real difference for animals, people, and the planet. 
          Our organisation is non-profit, and every cent is used for impact â€” not profit. To keep you connected, we share regular videos on 
          <a href="https://www.instagram.com/app.elunify/" target="_blank" rel="noopener noreferrer">Instagram</a>
          showing exactly where your donations go. Together, we can grow something bigger than ourselves. -->

          Our app is built with one goal: to inspire positive change for animals, people, and the planet. Unlike most apps, we donâ€™t rely on ads or distractions â€” 
          we focus entirely on creating a playful, meaningful experience that helps more people discover the joy and impact of this lifestyle.

          By supporting us, youâ€™re not funding profit â€” youâ€™re helping keep this project alive, independent, and free from ads. 
          Every contribution allows us to keep improving the app, adding new features, and reaching more people who want to make a difference.

          Together, weâ€™re building something bigger than ourselves â€” a movement for kindness, sustainability, and conscious living.
        </div>
      </div>
    </div>
  </div>

  <div class="optionssupportus">
    <div class="optionsupportus donate">
      <h3>Donate</h3>
      <p>
        Your donation makes a direct impact. Whether big or small, every contribution helps us grow. 
        As a thank-you, youâ€™ll receive XP and badges inside the app, and the top donors will be honored in our leaderboards.
      </p>
      <button class="button" id="donatebtn" onclick="window.location.href='donation.html'">Donate Now</button>
    </div>

    <div class="optionsupportus support">
      <h3>Support Us</h3>
      <p>
        Want to help but canâ€™t donate right now? You can still support us! By watching a short ad, you generate funds that we will use for the same projects. 
        As a thank-you, youâ€™ll also earn XP and badges â€” because every action matters.
      </p>
      <button class="button" id="adbtn" onclick="watchAd()">Watch an Ad</button>
    </div>


    <div class="optionsupportus membershipssupportus">
  <h3>Memberships</h3>
  <p>
    Want to support us long-term and unlock extra rewards? Become a member! Youâ€™ll get XP boosts, badges, and special recognition. 
  </p>
  <button class="button" id="memberbtn" onclick="toggleMemberships()">View Memberships</button>

  <div id="membership-list" style="display:none; margin-top:15px;">
    <h4>ğŸŒŸ Membership Tiers</h4>
    <div class="membership-cardssupportus">

      <div class="membership-cardsupportus">
        <h5>Seed Member ğŸŒ±</h5>
        <p>â‚¬2 / month</p>
        <ul>
          <li>+5% XP boost on all activities & badges for donations</li>
          <li>Seed badge in profile</li>
        </ul>
      </div>

      <div class="membership-cardsupportus">
        <h5>Sprout Member ğŸŒ¿</h5>
        <p>â‚¬5 / month</p>
        <ul>
          <li>+10% XP boost</li>
          <li>Exclusive badge</li>
        </ul>
      </div>

      <div class="membership-cardsupportus">
        <h5>Tree Member ğŸŒ³</h5>
        <p>â‚¬10 / month</p>
        <ul>
          <li>+20% XP boost</li>
          <li>Early access to new features</li>
          <li>Name in donor videos</li>
        </ul>
      </div>

      <div class="membership-cardsupportus">
        <h5>Forest Member ğŸŒ²</h5>
        <p>â‚¬20 / month</p>
        <ul>
          <li>+40% XP boost</li>
          <li>Highlighted spot on leaderboard</li>
          <li>Special recognition badge</li>
        </ul>
      </div>

      <div class="membership-cardsupportus">
        <h5>Earth Guardian Member ğŸŒ</h5>
        <p>â‚¬50 / month</p>
        <ul>
          <li>+100% XP boost</li>
          <li>Personal shoutout in videos</li>
          <li>VIP badge & profile highlight</li>
        </ul>
      </div>

    </div>
  </div>
</div>
</div>


</div>
<!-- AboutUs --> 
 <!-- AboutUs --> 
  <!-- AboutUs --> 
   <!-- AboutUs -->   
    <div id="aboutus" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      <div class="optionssupportus">
      <div class="optionaboutus">
      <h3>About us</h3>
      <p>
        We are a small, heart-driven initiative with one clear goal: to make a difference for animals, people, and the planet. 
        This project is not backed by big companies â€” itâ€™s personal, transparent, and honest. 
        Right now, itâ€™s just me working on it, but together with you, we can build a community that cares.
        By using this app, supporting, or even just being here, you are part of something that creates real-world impact. 
        We dream of a future where compassion grows stronger every day â€” and you are part of that story.
      </p>
     </div>
    </div>
  </div>
<!-- Sources -->
 <!-- Sources -->
  <!-- Sources -->
   <!-- Sources -->
    

   <div id="sources" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      ...Sources content... 
    </div>


<!-- Main features -->   
 <!-- Main features -->   
  <!-- Main features -->   
   <!-- Main features -->   
  
<!-- Daily Check-in -->
 <!-- Daily Check-in -->
  <!-- Daily Check-in -->
   <!-- Daily Check-in -->
    <div id="dailycheck-in" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
    
        <div id="quizDCI" class="boxDCI">
            <!-- JS will insert yesterday's quiz here -->
        </div>

        <div id="lessonsectionDCI" class="boxDCI">
          <label class = "bigLabelDCI">Your lesson for today:</label>
          <div id="dailyLessonDCI" class="lesson-boxDCI">
          <!-- JS will insert today's lesson here -->
          </div>
        </div>
    
        <div id="mealsectionDCI" class="boxDCI">
          <label class = "bigLabelDCI">How many plant-based meal did you have yesterday?</label>
        
          <label class="checkbox-labelDCI"><input type="radio" name="mealsDCI" value="1">I didnâ€™t have a plant-based meal.</label>
          <label class="checkbox-labelDCI"><input type="radio" name="mealsDCI" value="2">I had a few plant-based meals! </label>
          <label class="checkbox-labelDCI"><input type="radio" name="mealsDCI" value="3">Most of my meals were plant-based!</label>
          <label class="checkbox-labelDCI"><input type="radio" name="mealsDCI" value="4">I had a fully plant-based day! ğŸŒ±</label>

        </div>
    
        <button class="button" id="submitBtnDCI" onclick="handleSubmit()">Submit</button>
    
    </div>

<!-- Health Issues -->
 <!-- Health Issues -->
  <!-- Health Issues -->
   <!-- Health Issues -->
  <div id="healthissues" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
     
  <h2 class = "YourHealthIssueTitle">Your Health Issues</h2>

  <div class="learning-path-buttons">
    <!-- All possible health issues (initially hidden) -->
    <button class="path-btn hidden" data-path="Heart disease">Heart disease</button>
    <button class="path-btn hidden" data-path="High cholesterol">High cholesterol</button>
    <button class="path-btn hidden" data-path="High blood pressure">High blood pressure</button>
    <button class="path-btn hidden" data-path="Type 2 diabetes">Type 2 diabetes</button>
    <button class="path-btn hidden" data-path="Obesity">Obesity</button>
    <button class="path-btn hidden" data-path="Digestive issues">Digestive issues</button>
    <button class="path-btn hidden" data-path="Inflammation or swelling">Inflammation or swelling</button>
    <button class="path-btn hidden" data-path="Fatigue">Fatigue</button>
    <button class="path-btn hidden" data-path="Cancer risk">Concerned about cancer risk</button>
  </div>

  <!-- Courses / Lessons containers -->
  <div class="courses">
    <!-- one course container per health issue, initially hidden -->
    <div class="course hidden" id="Heart disease"><h3>Heart disease</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="High cholesterol"><h3>High cholesterol</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="High blood pressure"><h3>High blood pressure</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="Type 2 diabetes"><h3>Type 2 diabetes</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="Obesity"><h3>Obesity</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="Digestive issues"><h3>Digestive issues</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="Inflammation or swelling"><h3>Inflammation or swelling</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="Fatigue"><h3>Fatigue</h3><ul class="lesson-list"></ul></div>
    <div class="course hidden" id="Cancer risk"><h3>Concerned about cancer risk</h3><ul class="lesson-list"></ul></div>
  </div>
</div>

<!-- Hidden lesson tab -->
<div id="healthylesson-tab" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);">
  <button id="close-lesson">â¬… Back</button>
  <h2 id="lesson-title"></h2>
  <div id="lesson-content"></div>
  <div id="quiz-container"></div>
</div>
  
<!-- Meal Art Contest -->
 <!-- Meal Art Contest -->
  <!-- Meal Art Contest -->
   <!-- Meal Art Contest -->
    <div id="mealartcontest" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      
      <div id="mealArtContestSmall" class="tab-content">
  <!-- Header / Intro -->
  <div class="meal-art-header">
    <h2>Meal Art Contest</h2>
    <p class="generalnote" id="generalnote" style="display: inline-block">Upload your meal art from Tuesday to Sunday. Voting is on Monday.</p>

    <!-- Buttons -->
  <div class="header-buttons">
  <button id="uploadBtn" class="locked" data-unlock="ğŸ”“ Unlock at Lvl 10" style="display:none;">Upload My Meal</button>
  
  <p class="uploadnote hidden-meal" id="uploadnote">
    <a href="mailto:elunify.app@gmail.com">Restaurants: Request Pro Kitchen access â€” no level needed!</a>
  </p>
  
  <p class="votenote hidden-meal" id="votenote">It's a vote day! Pick your favorite!</p>
  
  <!-- New message when user already uploaded -->
  <p class="already-uploaded" id="alreadyUploadedMsg" style="display:none; color: green; font-weight: bold;">
    You uploaded your meal this week, congratulations!
  </p>
</div>
  </div>

  <!-- Main Tabs: Current Participants / Past Winners -->
  <div class="meal-art-main-tabs">
    <button class="main-tab active" data-tab="participants">Current Participants</button>
    <button class="main-tab" data-tab="past-winners">Past Winners</button>
  </div>

  <!-- Participants Gallery -->
<div class="main-tab-content hidden-meal" id="participants">
  <div class="participants-gallery">
    <div class="category-column" id="home-chef-column">
      <h4>Home Chef</h4>
      <!-- JS will insert current week meals here -->
      <div class="current-week-gallery" id="home-chef-gallery"></div>
    </div>

    <div class="category-column" id="pro-kitchen-column">
      <h4>Pro Kitchen</h4>
      <!-- JS will insert current week meals here -->
      <div class="current-week-gallery" id="pro-kitchen-gallery"></div>
    </div>
  </div>
</div>

<div class="main-tab-content hidden-meal" id="past-winners">
  <div class="past-winners-columns">
    <div class="category-column" id="home-chef-past">
      <h4>Home Chef</h4>
      <!-- JS will insert winners here -->
      <div class="winner-list" id="home-chef-winners"></div>
    </div>

    <div class="category-column" id="pro-kitchen-past">
      <h4>Pro Kitchen</h4>
      <!-- JS will insert winners here -->
      <div class="winner-list" id="pro-kitchen-winners"></div>
    </div>
  </div>
</div>

<!-- Recipe Modal -->
<div class="modal hidden-meal" id="mealArtrecipeModal" >
  <div class="modal-content">
    <span id="mealArtcloseModal" class="close">&times;</span>
    <h3 id="mealArtmodalFoodName"></h3>
    <h4>Ingredients:</h4>
    <p id="mealArtmodalIngredients"></p>
    <h4>Instructions:</h4>
    <p id="mealArtmodalInstructions"></p>
  </div>
</div>

</div>

<div class="MealArtUploadContent hidden-meal" id="MealArtUploadContent">

  <h2 class="UploadYourMeal">Upload Your Meal</h2>
  <p class="rule">Only plant-based meals are allowed!</p>

  <form id="mealUploadForm">
    <!-- Required Photo -->
    <label for="mealPhoto">Meal Photo <span style="color:red">*</span></label>
    <input type="file" id="mealPhoto" name="mealPhoto" accept="image/*" required>

    <!-- Preview Area -->
    <div class="mealArtpreview hidden-meal" id="mealArtphotoPreview">
      <img id="mealArtpreviewImage" src="" alt="Meal Preview">
    </div>

    <!-- Optional Recipe -->
     <p class="recipe-note">Fill all boxes to make your recipe available:</p>

    <label for="recipeName">Recipe Name <span class="optional-label">(optional)</span></label>
    <input type="text" id="mealArtrecipeName" name="mealArtrecipeName" placeholder="E.g., Vegan Lasagna">

    <label for="mealArtrecipeIngredients">Ingredients <span class="optional-label">(optional)</span></label>
    <textarea id="mealArtrecipeIngredients" name="mealArtrecipeIngredients" placeholder="List ingredients here..."></textarea>

    <label for="mealArtrecipeInstructions">Instructions <span class="optional-label">(optional)</span></label>
    <textarea id="mealArtrecipeInstructions" name="mealArtrecipeInstructions" placeholder="Write instructions here..."></textarea>

    <button class= "button" id="sbmtMealArtBtn" type="submit">Submit Meal</button>
  </form>


</div>

</div>

<!-- Learn subsections -->
 <!-- Learn subsections -->
  <!-- Learn subsections -->
   <!-- Learn subsections -->
    <div id="lessons" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      <div class="learning-path-buttons">
        <h2>Learn</h2>
    <button class="path-btn" data-path="animals">For the Animals</button>
    <button class="path-btn" data-path="earth">For the Earth</button>
    <button class="path-btn" data-path="health">For Health</button>
  </div>

  <!-- Courses / Lessons containers -->
<div class="courses">

  <div class="course hidden" id="animals">
    <h3>For the Animals</h3>
    <ul class="extralesson-list"></ul>
  </div>

  <div class="course hidden" id="earth">
    <h3>For the Earth</h3>
    <ul class="extralesson-list"></ul>
  </div>

  <div class="course hidden" id="health">
    <h3>For Health</h3>
    <ul class="extralesson-list"></ul>
  </div>

 </div>
</div>

<!-- Recipes -->
 <!-- Recipes -->
  <!-- Recipes -->
   <!-- Recipes -->
    <div id="recipes" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      <h2>Recipes</h2>
  <div id="recipes-container" class="recipes-container">
    <!-- Recipes will be loaded here dynamically -->
  </div>
  <!-- Upload Recipe Button -->
  <button id="openUploadBtn" class="upload-btn">â• Upload Your Own Recipe</button>
    </div>

<!-- Recommendations -->
 <!-- Recommendations -->
  <!-- Recommendations -->
   <!-- Recommendations -->
      <div id="recommendations" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      <h2 class="recommendation-title">ğŸ“š Recommendations</h2>

  <!-- Books -->
  <div class="recommendation-section" id="recommendation-books">
    <h3 class="recommendation-subtitle">Books</h3>
    <ul class="recommendation-list">
      <li class="recommendation-item">
        <strong>Book:</strong> "Harry Potter" series <em>by J.K. Rowling</em>
      </li>
      <li class="recommendation-item">
        <strong>Book:</strong> "Sapiens: A Brief History of Humankind" <em>by Yuval Noah Harari</em>
      </li>
      <li class="recommendation-item">
        <strong>Book:</strong> "The Vegan Way" <em>by Jackie Day</em>
      </li>
    </ul>
  </div>

  <!-- Movies -->
  <div class="recommendation-section" id="recommendation-movies">
    <h3 class="recommendation-subtitle">Movies</h3>
    <ul class="recommendation-list">
      <li class="recommendation-item">
        <strong>Movie:</strong> "Soul" (Pixar, 2020)
      </li>
      <li class="recommendation-item">
        <strong>Movie:</strong> "Okja" (Netflix, 2017)
      </li>
      <li class="recommendation-item">
        <strong>Movie:</strong> "Into the Wild" (2007)
      </li>
    </ul>
  </div>

  <!-- Websites -->
  <div class="recommendation-section" id="recommendation-websites">
    <h3 class="recommendation-subtitle">Websites</h3>
    <ul class="recommendation-list">
      <li class="recommendation-item">
        <strong>Website:</strong> <a href="https://www.vegan.com" target="_blank">Vegan.com</a>
      </li>
      <li class="recommendation-item">
        <strong>Website:</strong> <a href="https://www.goodreads.com" target="_blank">Goodreads</a>
      </li>
      <li class="recommendation-item">
        <strong>Website:</strong> <a href="https://www.imdb.com" target="_blank">IMDB</a>
      </li>
    </ul>
  </div>
    
    
    
      </div>

    <!-- Explore subsections -->
        <!-- Explore subsections -->
            <!-- Explore subsections -->
                <!-- Explore subsections -->

<!-- Restaurant map -->
 <!-- Restaurant map -->
  <!-- Restaurant map -->
   <!-- Restaurant map -->
    <div id="restaurants" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      <h2 class="map-title">Discover Vegan-Friendly Restaurants ğŸ´</h2>
  <div id="mapContainer" class="map-container"></div>
  <div id="mapResult" class="map-result"></div>

  
    </div>
<!-- Scan -->
 <!-- Scan -->
  <!-- Scan -->
   <!-- Scan -->
    <div id="scan" class="page hidden" style="margin-top: 30px; margin-bottom: 80px;"> 
  <h2 class="scan-title">Scan a Product for Information ğŸ“·</h2>

  <!-- Scan button -->
  <button id="startScanBtn" class="button" style="display:block; margin:auto;">ğŸ“· Scan Product</button>

  <!-- Camera container -->
  <div id="scanContainer" class="scan-container hidden">
    <video id="scanVideo" width="300" height="300" autoplay></video>
    <div id="scanLoader" class="scan-loader" style="display:none;">â³ Scanning product...</div>
  </div>

  <!-- Product display container -->
  <div id="scanResult" class="scan-result hidden"></div>

  <!-- Scan another product button -->
  <button id="scanAgainBtn" class="scan-again-btn hidden" style="display: block; margin: auto; margin-bottom: 4rem;">ğŸ”„ Scan Another Product</button>

  <!-- Leaflet CSS & JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    </div>

    <!-- Community subsections -->
     <!-- Community subsections -->
      <!-- Community subsections -->
       <!-- Community subsections -->
  
<!-- Local Community -->
 <!-- Local Community -->
  <!-- Local Community -->
   <!-- Local Community -->

    <div id="local" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      <div id="communityCardWrapper">
  <div class="community-card" id="joinCommunityCard">
    <h5 class="localCommunityh2">Find your local community</h5>
    <select id="countrySelect">
      <option value="">Select country</option>
    </select>
    <select id="citySelect" disabled>
      <option value="">Select city</option>
    </select>
    <button id="joinCommunityBtn" disabled>Join Community</button>
    <button id="leaveCommunityBtn" style="display:none;">Leave Community</button>
    <p id="joinedCommunityText" style="margin-top:1rem;"></p>
  </div>

  <!-- Community Dashboard (hidden by default) -->
  <div class="community-dashboard" id="communityDashboard" style="display:none;">
  <div class="community-section">
    <h3 id="communityTitle"></h3> <!-- Title will be inserted here -->
    <div class="community-section-header">Community Chat â–¼</div>
    <div class="community-section-content" id="communityChatSection">
      <div id="communityMessages" class="chat-box"></div>
      <input type="text" id="communityMessageInput" placeholder="Type a message...">
      <button id="sendCommunityMessageBtn">Send</button>
    </div>
  </div>

  <div class="community-section">
    <div class="community-section-header">Upcoming Events â–¼</div>
    <div class="community-section-content" id="communityEventsSection">
    
    <ul id="communityEventsList">
      <!-- Events populated dynamically -->
    </ul>
    <!-- Create Event Form -->
    <div id="createEventForm">
      <button id="createEventBtn">Create Event</button>
      
      <div id="createEventInputs" style="display:none; margin-top:0.5rem;">
        <input type="text" id="eventPlaceInput" placeholder="Event place" />
        <input type="text" id="eventDescriptionInput" placeholder="Description" />
        <input type="datetime-local" id="eventTimeInput" />
    <button id="submitEventBtn">Submit Event</button>
      </div>
    </div>

  </div>
  </div>

  <div class="community-section">
  <div class="community-section-header">Members â–¼</div>
  <div class="community-section-content" id="communityMembersSection" style="display: none;">
    <ul id="communityMembersList">
      <!-- Members populated dynamically -->
    </ul>
  </div>
</div>

  <button id="leaveCommunityDashboardBtn">Leave Community</button>
</div>

</div>
    </div>

<!-- Anonymous Forum -->
 <!-- Anonymous Forum -->
  <!-- Anonymous Forum -->
   <!-- Anonymous Forum -->
    <div id="forum" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      <!-- Anonymous forum -->
    <section class="AFsection" id="forum">
        <div class="AFsection-content">
  <p class="forum-quote">
  <span class="quote-text">
    <em>"That is the best of humanity: When we support each other. Not when we cancel each other out for past mistakes, but when we help each other to grow."</em>
  </span>
  
  <span class="quote-source">
    <a href="https://www.youtube.com/watch?v=WVPw0UrjLuo" target="_blank" rel="noopener noreferrer" class="quote-link">
      â€” Joaquin Phoenix, Oscars 2020
    </a>
  </span>
  
  <span class="forum-guideline">
    Please share your thoughts kindly and help others grow ğŸ§¡
  </span>
</p>

<ul id="forumMessages"></ul>

      <div id="newBlock">
    <textarea id="blockContent" placeholder="Open a topic anonymously..." rows="3"></textarea>
    <button id="submitBlockBtn">Submit</button>
      </div>
      
        </div>
    </section>

    <!-- Popup for comments -->
<div id="AFcommentPopup" class="AFpopup hidden">
  <div class="AFpopup-content">
    <span id="AFclosePopup" class="close">&times;</span>
    <div id="AFpopupBlockContent"></div>
    <ul id="AFpopupCommentsList"></ul>
    <input type="text" id="AFnewCommentInput" placeholder="Write your comment...">
    <button class = "button" id="AFsubmitCommentBtn">Comment</button>
  </div>
</div>

    </div>

<!-- Friends -->
 <!-- Friends -->
  <!-- Friends -->
   <!-- Friends -->
    <div id="friends" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      <!-- Search / Send Request -->
  <div class="friend-search-container">
    <button id="openSearchPopup" class="search-btn">ğŸ” Search a Friend</button>
  </div>

  <div id="searchPopup" class="popup">
    <div class="popup-content">
      <span id="closeSearchPopup" class="close">&times;</span>
      <input id="friendEmailInput" type="email" placeholder="Enter your friend's email." />
      <button id="sendFriendRequestBtn">Send Request</button>
    </div>
  </div>

  <!-- Incoming Requests -->
  <ul id="incomingRequestsList"></ul>

  <!-- Accepted Friends -->
  <p class="friendsTitle">Friends:</p>
  <ul id="friendsList"></ul>
    </div>



<!-- Messages -->
 <!-- Messages -->
  <!-- Messages -->
   <!-- Messages -->
<div id="messages" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      <h2>Messages</h2>
    <div class="messages-container">
      <div id="chatListView">
        <div class="chat-list-header"><h3>Chats</h3></div>
        <ul id="chatListItems"></ul>
      </div>
      <div id="chatView" class = "hidden">
        <div class="chat-header">
          <span id="backToList" class="back-arrow">â¬…ï¸</span>
          <span id="chatHeader">Chat</span>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
          <input type="text" id="messageInput" placeholder="Type a message...">
          <button id="sendMessageBtn">Send</button>
        </div>
      </div>
    </div>

  <div id="newChatPopup" class="hidden">
  <div class="popup-content">
    <span id="closePopup" class="close">&times;</span>
    <h3>Select a friend to message</h3>
    <ul id="friendsListPopup"></ul>
  </div>
</div>

</div>

<!-- Mentorship -->
 <!-- Mentorship -->
  <!-- Mentorship -->
   <!-- Mentorship -->

    <div id="mentorship" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
       <section class="section" id="buddy">
  <h2>Buddy System ğŸ¤</h2>

  <div class="section-content">
    <p id="ConnectWithAMentor">Connect with someone who has been vegan longer for mentorship.</p>
    <!-- Row to display if user is already a mentor -->
<div id="alrdymentor" style="display: none;">
  <p class="youareamentorP"> You are a mentor </p>
  <button id = "endmentorship">End mentorships</button>
</div>

 <p class="mentorlisttitle">Mentors:</p> 
    <!-- Mentor list -->
    <ul id="mentorsList" class="mentor-list"></ul>
<!-- Apply to be mentor button -->
    <button id="applyMentorBtn">Apply to be a mentor</button>

    <!-- Popup Modal -->
<div id="mentor-popup" class="mentor-hidden mentor-popup-overlay">
  <div class="mentor-popup">
    <h2 class="mentor-title">Apply as Mentor</h2>
    <label for="mentor-years">How long are you being a vegan?</label>
    <input type="number" id="mentor-years" class="mentor-input" min="0" placeholder="Enter years" />
    <button id="mentor-submit" class="mentor-button">Submit</button>
    <button id="mentor-cancel" class="mentor-button mentor-cancel">Cancel</button>
  </div>
</div>

    
  </div>
</section>

</div>

    <!-- Playground subsections -->
     <!-- Playground subsections -->
      <!-- Playground subsections -->
       <!-- Playground subsections -->

<!-- ProfileCard -->
 <!-- ProfileCard -->
  <!-- ProfileCard -->
   <!-- ProfileCard -->
    <div id="profilecard" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      Demo page - NOT WORKING SECTION <br> <br> It will be an editable card users can show about themselves in the community 

    <div id="ProfileCardContainer">
    <div class="ProfileAvatar"><div class="ProfileAvatar" style="background-image:url('characters/eluna.png'); width:7rem; height:7rem; display: block; margin: auto; background-size:cover; border-radius:50%;"></div></div>

    <div class="ProfileTitle">
      <h2 contenteditable="false">Eluna</h2>
      <span class="TitleText EditableField" contenteditable="true">Sprout Member</span>
    </div>

    <div class="ProfileStats">
      <p>Animals saved: <span class="EditableField" contenteditable="true">120 ğŸ®</span></p>
      <p>Streak: <span class="EditableField" contenteditable="true">15 days ğŸ”¥</span></p>
    </div>

    <div class="ProfileAchievements">
      <h3>Achievements</h3>
      <div class="AchievementsList">
        <span class="AchievementBadge">ğŸŒ± Seed Member</span>
        <span class="AchievementBadge">ğŸ® Saver of Hundreds</span>
        <span class="AchievementBadge">â­ Daily Streak Star</span>
      </div>
    </div>
  </div>  
    
    </div>
<!-- Achievements -->
 <!-- Achievements -->
  <!-- Achievements -->
   <!-- Achievements -->
    <div id="avatar" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      Demo page - NOT WORKING SECTION
    
      <section id="AchievementsInfo">
<p>Earn achievements to unlock special titles that appear next to your name and are visible to the community. You can proudly display these rewards on your profile card to show off your progress and impact.</p>
</section>


<section id="AchievementsList">

<div class="Achievement">
<div class="symbol">ğŸ®</div>
<h4>Saver of Hundreds of Animals</h4>
<p>Unlocked when your counter reaches 100 saved animals.</p>
</div>

<div class="Achievement">
<div class="symbol">ğŸ¤</div>
<h4>Buddy Helper</h4>
<p>Helped another user start their vegan journey.</p>
</div>

<div class="Achievement">
<div class="symbol">ğŸ¡</div>
<h4>Local Hero</h4>
<p>Participated in a local vegan meetup or event.</p>
</div>

<div class="Achievement">
<div class="symbol">â­</div>
<h4>Special Symbol</h4>
<p>Extra unlockable symbols and pictures to decorate your card.</p>
</div>

<div class="Achievement">
<div class="symbol">ğŸŒ±</div>
<h4>Seed Member</h4>
<p>Unlocked with subscription â€” your journey begins.</p>
</div>


<div class="Achievement">
<div class="symbol">ğŸŒ¿</div>
<h4>Sprout Member</h4>
<p>Unlocked after growing your streak â€” shows your progress.</p>
</div>


<div class="Achievement">
<div class="symbol">ğŸŒ³</div>
<h4>Tree Member</h4>
<p>Unlocked after reaching a strong milestone.</p>
</div>


<div class="Achievement">
<div class="symbol">ğŸŒ²</div>
<h4>Forest Member</h4>
<p>Unlocked as you become a major contributor.</p>
</div>


<div class="Achievement">
<div class="symbol">ğŸŒ</div>
<h4>Earth Guardian Member</h4>
<p>The highest member tier â€” show it off with pride.</p>
</div>
</section>
    
    </div>

<!-- Shop -->
 <!-- Shop -->
  <!-- Shop -->
   <!-- Shop -->
    <div id="shop" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 

       Demo page - NOT WORKING SECTION

       <section id="ShopWallet">
<div class="badge-count">
<div class="badge-icon">10</div>
<span>Your Badges: 24</span>
</div>
</section>


<section id="ShopMethods">
<h3>How to get badges</h3>
<ul>
<li>Watch an ad â†’ +1 badge per ad</li>
<li>Buy badges â†’ 10 badges = â‚¬1</li>
<li>Daily check-in & complete challenges</li>
</ul>
</section>


<section id="ShopProducts">
<div class="ShopProduct">
<h4>Streak Freezer</h4>
<div class="price">10 badges</div>
<p>Protect your streak for one missed day.</p>
<button disabled>Buy</button>
</div>


<div class="ShopProduct">
<h4>Double XP (24h)</h4>
<div class="price">15 badges</div>
<p>All progress counts double for 24 hours.</p>
<button disabled>Buy</button>
</div>


<div class="ShopProduct">
<h4>Visual Sanctuary</h4>
<div class="price">50 badges</div>
<p>See the animals you saved in a personal sanctuary view.</p>
<button disabled>Buy</button>
</div>
</section>


    </div>

<!-- LeaderBoards -->
 <!-- LeaderBoards -->
  <!-- LeaderBoards -->
   <!-- LeaderBoards -->
  <div id="leaderboards" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
      <div class="leaderboard-container" id="leaderboards">
<h2>Leaderboards</h2>
  <!-- Overall Leaderboards -->
  <div class="leaderboard" data-period="overall">
    <h3 onclick="toggleListLeader(this)">Biggest Impact</h3>
    <ul id="overall-impact">
      <!-- JS will insert top 10 impact users here -->
    </ul>
  </div>

  <div class="leaderboard" data-period="overall">
    <h3 onclick="toggleListLeader(this)">Most XP</h3>
  <ul id="overall-level">
    <!-- JS will insert top 10 users by XP here -->
  </ul>
  </div>

  <div class="leaderboard" data-period="overall">
    <h3 onclick="toggleListLeader(this)">Biggest Streak</h3>
    <ul id="overall-streak">
      <!-- JS will insert top 10 streak users here -->
    </ul>
  </div>

</div>

</div>

<!-- Challenges -->
 <!-- Challenges -->
  <!-- Challenges -->
   <!-- Challenges -->
    <div id="challenges" class="page hidden" style="margin-top: env(safe-area-inset-top, 30px); margin-bottom: env(50px+safe-area-inset-bottom, 80px);"> 
      
<div class="challenge-list">

  Demo page - NOT WORKING SECTION

<div class="challenge-card">
<h3>ğŸŒ± Fully Plant-Based Month</h3>
<p>Check in each day that you had a fully plant-based day. Fill 30 slots to finish the month.</p>
<div class="progress"><div style="width:60%"></div></div>
<div class="badge-count">Badges: 12</div>
<button>Check in</button>
</div>


<div class="challenge-card">
<h3>ğŸ¤ Find 10 Friends</h3>
<p>Invite friends to join Vegan Buddies. Each accepted invite counts toward the goal.</p>
<div class="progress"><div style="width:40%"></div></div>
<button>Invite</button>
</div>


<div class="challenge-card">
<h3>ğŸ¨ Meal-Art Contest â€” 5x Streak</h3>
<p>Participate in five contests in a row. Keep your streak alive to win creative rewards.</p>
<div class="progress"><div style="width:60%"></div></div>
<div class="badge-count">Streak: 3</div>
<button>Enter Contest</button>
</div>


<div class="challenge-card">
<h3>ğŸŒ Increase Impact â€” Invite a Friend</h3>
<p>Invite friends â€” when they log their first plant-based day, your impact increases together.</p>
<div class="progress"><div style="width:25%"></div></div>
<button>Invite</button>
</div>


<div class="challenge-card">
<h3>ğŸ Monthly Mystery Box</h3>
<p>Complete small missions across the month. Collect 5 mission points and open a mystery box.</p>
<div class="progress"><div style="width:40%"></div></div>
<button>Complete Mission</button>
</div>

</div>
</div>

    <!-- ğŸ”– Bottom Navigation -->
    <div class="bottom-nav">
      <button onclick="showSection('home')">ğŸ </button>
      <div class="dropdown">
        <button>ğŸ“– </button>
        <div class="dropdown-content">
          <button onclick="showSection('lessons')">Lessons</button>
          <button onclick="showSection('recipes')">Recipes</button>
          <button onclick="showSection('recommendations')">Recommendations</button>
        </div>
      </div>
      <div class="dropdown">
        <button>ğŸ” </button>
        <div class="dropdown-content">
          <button onclick="showSection('restaurants')">Restaurants</button>
          <button onclick="showSection('scan')">Scan Products</button>
        </div>
      </div>
      <div class="dropdown">
        <button>ğŸŒ </button>
        <div class="dropdown-content">
          <button onclick="showSection('local')">Local Community</button>
          <button onclick="showSection('forum')">Anonymous Forum</button>
          <button onclick="showSection('friends')">Friends</button>
          <button onclick="showSection('messages')">Messages</button>
          <button onclick="showSection('mentorship')">Mentorship</button>
        </div>
      </div>
      <div class="dropdown">
        <button>ğŸ§¸ </button>
        <div class="dropdown-content">
          <button onclick="showSection('profilecard')">Your Profile Card</button>
          <button onclick="showSection('avatar')">Achievements</button>
          <button onclick="showSection('shop')">Shop</button>
          <button onclick="showSection('leaderboards')">Leaderboards</button>
          <button onclick="showSection('challenges')">Challenges</button>
        </div>
      </div>
    </div>

</div> 
<!-- End main-container -->
 <!-- End main-container -->
  <!-- End main-container -->
   <!-- End main-container -->
    <!-- End main-container -->

<div class="avatar-row">
  <!-- Eluna -->
  <div class="profile-wrapper" id="elunaWrapper">
    <img class="avatar" src="characters/eluna.png" alt="Eluna">
    <div class="thought-toggle">ğŸ’­</div>
    <div id="elunaThought" class="thought-bubble">
      <span>Eluna</span> says...
      <div id="elunaTip" class="lesson-box"></div>
      <span class="close-thought">Ã—</span>
    </div>
  </div>

  <!-- Elune -->
  <div class="profile-wrapper" id="eluneWrapper">
    <img class="avatar" src="characters/elune.png" alt="Elune">
    <div class="thought-toggle">ğŸ’­</div>
    <div id="eluneThought" class="thought-bubble">
      <span>Elune</span> says...
      <div id="eluneTip" class="lesson-box"></div>
      <span class="close-thought">Ã—</span>
    </div>
  </div>

  <!-- Pet -->
  <div class="profile-wrapper" id="petWrapper">
    <div class="avatar" id="petAvatar"></div>
    <div class="thought-toggle">ğŸ’­</div>
    <div id="petThought" class="thought-bubble">
      <span id="petName">Pet</span> says...
      <div id="petTip" class="lesson-box"></div>
      <span class="close-thought">Ã—</span>
    </div>
  </div>

  <!-- Celebrity -->
<div class="profile-wrapper" id="celebrityWrapper">
  <img class="avatar" id="celebrityAvatar" src="" alt="Celebrity Avatar">
  <div class="thought-toggle">ğŸ’­</div>
  <div id="celebrityThought" class="thought-bubble">
    <div id="celebrityQuote" class="lesson-box"></div>
    <span class="close-thought">Ã—</span>
  </div>
</div>

</div>
<!-- End homepageContent -->
 <!-- End homepageContent -->
  <!-- End homepageContent -->
   <!-- End homepageContent -->
    <!-- End homepageContent -->

<!-- POPUPS -->
 <!-- POPUPS -->
  <!-- POPUPS -->
   <!-- POPUPS -->
    <!-- POPUPS -->

<!-- Popup: Animals -->
<div id="popupAnimals" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <div id="animalsSentence"></div> <br> 
    <p>See how far your impact can go:</p>
      <span class="openCalculator">
        Use our impact calculator
      </span>
    </p>
  </div>
</div>

<!-- Popup: Forest -->
<div id="popupForest" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <div id="forestSentence"></div> <br> 
    <p>See how far your impact can go:</p>
      <span class="openCalculator">
        Use our impact calculator
      </span>
    </p>
  </div>
</div>

<!-- Popup: Water -->
<div id="popupWater" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <div id="waterSentence"></div> <br> 
    <p>See how far your impact can go:</p>
      <span class="openCalculator">
        Use our impact calculator
      </span>
    </p>
  </div>
</div>

<!-- Popup: CO2 -->
<div id="popupCO2" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <div id="co2Sentence"></div> <br> 
    <p>See how far your impact can go:</p>
      <span class="openCalculator">
        Use our impact calculator
      </span>
    </p>
  </div>
</div>

<!-- Popup: Impact Calculator -->
<div id="impactcalculator" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <h2 id="ImpactCalcTitle">Impact Calculator</h2>

    <div class="calculator-inputs">
      <label>
        Years:
        <input type="number" id="years" min="0" value="0">
      </label>
      <label>
        Months:
        <input type="number" id="months" min="0" max="11" value="0">
      </label>
      <button id="calculateImpactBtn">Calculate Impact</button>
    </div>

    <div class="calculator-results hidden" id="impactResults">
      <p>Animals saved: <span class="highlight" id="calcAnimals">0</span></p>
      <p>Forest saved: <span class="highlight" id="calcForest">0</span> mÂ²</p>
      <p>Water saved: <span class="highlight" id="calcWater">0</span> liters</p>
      <p>COâ‚‚ reduced: <span class="highlight" id="calcCO2">0</span> kg</p>
    </div>
  </div>
</div>

<!-- Popup: Amateur Home Chef -->
<div id="popupAmateur" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <img id="amateurImagePopup" src="meals/amateur.jpg" alt="Amateur winning dish" class="meal-art-image">
  </div>
</div>

<!-- Popup: Pro Kitchen -->
<div id="popupProfessional" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <img id="proImagePopup" src="meals/professional.jpg" alt="Professional winning dish" class="meal-art-image">
  </div>
</div>

<!-- Popup: MealArt -->
<div id="mealPopup" class="popup hidden">
  <div class="popup-content">
    <button class="popup-close">âœ–</button>
    <img id="popupMealImage" src="" alt="Meal" class="meal-art-image">
  </div>
</div>

<!-- Recipe Modal -->
<div id="recipeModal" class="popup hidden">
  <div class="popup-content">
    <button id="closeModal" class="popup-close">âœ–</button>
    <h2 id="modalFoodName"></h2>
    <h3>Ingredients</h3>
    <p id="modalIngredients"></p>
    <h3>Instructions</h3>
    <p id="modalInstructions"></p>
  </div>
</div>

<!-- Upload Recipe Modal -->
<div id="upload-recipe" class="modal hidden-modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h2>Upload a New Recipe</h2>
    <form id="recipeForm">
      <label>
        Recipe Image:
        <input type="file" id="recipeImage" accept="image/*" required>
      </label>
      <div id="imagePreview" style="width:150px; height:150px; border:1px solid #ccc; display:none; align-items:center; justify-content:center; overflow:hidden; border-radius:10px; margin:auto; margin-bottom: 0.5rem;">
  <img id="previewImg" style="display:block;width:100%; height:100%; object-fit:cover; margin-bottom: 0.5rem;">
</div>
      <label>
        Title:
        <input type="text" id="recipeTitle" required>
      </label>
      <label>
        Ingredients:
        <textarea id="recipeIngredients" placeholder="List ingredients..." required></textarea>
      </label>
      <label>
        Instructions:
        <textarea id="recipeInstructions" placeholder="Step by step instructions..." required></textarea>
      </label>
      <button type="submit">Upload Recipe</button>
    </form>
    <div id="uploadFeedback" style="margin-top:10px;"></div>
  </div>
</div>
<!-- Recipe Details Modal -->
<div id="recipe-modal" class="hidden-modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <img id="modal-img" src="" alt="" class="modal-img">
    <h2 id="modal-title"></h2>
    <p id="modal-ingredients"></p>
    <p id="modal-instructions"></p>
  </div>
</div>
<!-- Profile card -->
<div class="CommunityUser">
  <div class="ProfileAvatar" style="background-image:url('characters/eluna.png'); width:7rem; height:7rem; display: block; margin: auto; background-size:cover; border-radius:50%;"></div>
  <span>Eluna</span>
</div>
<!-- Demo Profile Card Popup -->
<div id="ProfileCardDemo" class="profile-card">
  DEMO, NOT READY YET, this card will be personalised with the current user's datas and achievements
  <button class="close-btn">Ã—</button>
  <div class="ProfileAvatarLarge" style="background-image:url('characters/eluna.png'); width:7rem; height:7rem; background-size:cover; border-radius:50%; margin:auto;"></div>
  <h2>Eluna <span class="title">Sprout Member</span></h2>
  <p>Animals saved: 120 ğŸ®</p>
  <p>Streak: 15 days ğŸ”¥</p>

  <h3>Achievements</h3>
  <div class="achievements-list">
    <span class="achievement">ğŸŒ± Seed Member</span>
    <span class="achievement">ğŸ® Saver of Hundreds</span>
    <span class="achievement">â­ Daily Streak Star</span>
  </div>
</div>

</div> 

<script type="module" src="supabaseClient.js"></script>
<script type="module" src="scriptpools.js"></script>
<script type="module" src="scriptreads.js"></script>
<script type="module" src="scriptfunctions.js"></script>
<script type="module" src="scriptmealartcontest.js"></script> 
<script src="scriptbuttons.js"></script>

<!-- Optional: Google Maps API (if needed) -->
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwHL9UaF4A7qSZt_qkW2QrZVnQWXeVFNs&libraries=places,marker&callback=initMap"
  async defer>
</script>


  <script type="module">
  import { supabase } from "./supabaseClient.js";
  document.addEventListener("DOMContentLoaded", async () => {
  const loadingOverlay = document.getElementById("loadingOverlay");
  const homepageContent = document.getElementById("homepageContent"); // wrap your homepage content

  // Helper: Calculate level from XP
  function getLevelFromXP(totalXP) {
    let level = 1;
    let xpNeededForNext = 100;
    let xpLeft = totalXP;

    while (xpLeft >= xpNeededForNext && level < 100) {
      xpLeft -= xpNeededForNext;
      level++;
      xpNeededForNext = Math.floor(xpNeededForNext * 1.05);
    }

    return { level, xpTowardsNextLevel: xpLeft, xpNeededForNextLevel: xpNeededForNext };
  }

  // Wait for auth and profile
  const { data: { user }, error: authError } = await supabase.auth.getUser();
  if (!user || authError) {
    console.warn("Not logged in or auth error:", authError);
    if (loadingOverlay) loadingOverlay.style.display = "none";
    if (homepageContent) homepageContent.style.opacity = 1;
    return;
  }

  const { data: profile, error: profileError } = await supabase
    .from("profiles")
    .select("*")
    .eq("id", user.id)
    .single();

  if (!profile || profileError) {
    console.error("Profile not found:", profileError);
    if (loadingOverlay) loadingOverlay.style.display = "none";
    if (homepageContent) homepageContent.style.opacity = 1;
    return;
  }

  // Wait for all images on the page
  await Promise.all(Array.from(document.images).map(img => {
    if (img.complete) return Promise.resolve();
    return new Promise(resolve => img.onload = img.onerror = resolve);
  }));

  // Optional delay 
  await new Promise(resolve => setTimeout(resolve, 600)); //1000 = 1 second

  // Update XP progress
  const countersElements = {
    levelBar: document.getElementById('levelProgress'),
    currentLevelEl: document.getElementById("currentLevel"),
  };

  const { level, xpTowardsNextLevel, xpNeededForNextLevel } = getLevelFromXP(profile.total_xp || 0);

  if (countersElements.levelBar) {
    if (level >= 100) {
      countersElements.levelBar.style.display = "none";
    } else {
      countersElements.levelBar.style.display = "block";
      let progressPercent = (xpTowardsNextLevel / xpNeededForNextLevel) * 100;
      progressPercent = Math.min(progressPercent, 100);
      countersElements.levelBar.style.width = progressPercent + '%';
      // countersElements.levelBar.textContent = progressPercent.toFixed(0) + '%'; // optional
      if (countersElements.currentLevelEl) countersElements.currentLevelEl.textContent = level;
    }
  }

  // Show the page
  if (loadingOverlay) loadingOverlay.style.display = "none";
  if (homepageContent) homepageContent.style.opacity = 1;
});
</script>
</body>
</html>